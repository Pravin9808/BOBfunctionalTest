pipeline {
    agent any
    tools{
        jdk "JAVA_HOME"
        maven "MAVEN"
        }
    stages {
        stage('Test') {
            steps {
                bat "mvn -D clean test"  
                publishHTML([allowMissing: false, alwaysLinkToLastBuild: false, keepAll: false, reportDir: '', reportFiles: 'test-output/emailable-report.html', reportName: 'HTML Report', reportTitles: '', useWrapperFileDirectly: true])

          }
        }
    }
    post {  
         always {  
             //def console_output = "${env.BUILD_URL}/console" 
             emailext( bcc: '', body: "Details: ${env.JOB_NAME} Build Number: ${env.BUILD_NUMBER} Build: ${env.BUILD_URL} Console Output: ${env.BUILD_URL}/console Body: ${FILE,path="test-output/emailable-report.html"}', mimeType: 'text/html'", cc: '', from: 'pravininteractive25@gmail.com', replyTo: '', subject: 'Test Execution Status', to: 'pravin.kumar@interactiveavenues.com'
        ) }  
    }   

}
