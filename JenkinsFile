pipeline {
    agent any
    tools{
        jdk "JAVA_HOME"
        maven "MAVEN"
        }
    stages {
        stage('Test') {
            steps {
                bat "mvn -D clean test"  
                publishHTML([allowMissing: false, alwaysLinkToLastBuild: false, keepAll: false, reportDir: '', reportFiles: 'test-output/emailable-report.html', reportName: 'HTML Report', reportTitles: '', useWrapperFileDirectly: true])

          }
        }
    }
    post {  
         always {  
             //def console_output = "${env.BUILD_URL}/console" 
                emailext (from:'pravininteractive25@gmail.com', to: 'pravin.kumar@interactiveavenues.com',subject: "Email report from '${env.JOB_NAME}'",
               body:readFile("test-output/emailable-report.html"), mimeType: 'text/html');
                 }  
    }   

}
